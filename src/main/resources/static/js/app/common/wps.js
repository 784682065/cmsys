/** * 外跑公共JS * */ var wps = {    initDetail: function () {  //从待办和跟踪列表进入详情的统一方法，页面均使用模板form_view.html        var that = this;        commons.bind();           //事件绑定        this.bind();           //事件绑定        commons.pageVal();        pageType = "wp";        listType = getCookie("listType");     //从列表cookie获取列表类型        businessId = getCookie("businessId"); //从列表cookie获取业务关键ID        if (listType == "wait") {            instanceId = getCookie("instanceId");            nodeId = getCookie("nodeName");            taskId = getCookie("taskId");            prodict = getCookie("prodict");            receiveType = getCookie("receiveType");            commons.getMsgName();    //获取当前用户意见名称            commons.getMsgList();     //流转意见数据获取，必须跟在getMsgName后面            if (receiveType == "view") {                $("#wirte,.footer").hide().remove();                if (msgListNull == 0) {  //预览的时候如果没有意见列表                    $(".myIdea").parent().hide().remove();                } else {                    $(".myIdea").hide().remove();                }            } else {                commons.getRightBtn();    //底部按钮控件及权限渲染，如果是重新保存的情况渲染页面是input,否则为p            }            commons.getWpContent();   //外跑页面业务数据获取            commons.getInitTask();   //启动任务            commons.getMustMsg();    //获取是否必须要提交意见内容        } else if (listType == "my") {            $(".footer").hide().remove();            commons.getWpContent();            commons.getMsgList();        }        commons.getFileList();    //页面附件列表获取        commons.pageStyle();      //特殊样式页面渲染    },    bind: function () {  // 通用元素事件绑定        var that = this;        $("#approval").click(function () { //审核同意            $(".locked").fadeIn();            $(".modalBg").hide();            submitType = 1; //同意            wps.normalSub();        });        $("#reject").click(function () { //驳回            $(".locked").fadeIn();            $(".modalBg").hide();            submitType = 2; //同意            wps.normalSub();        });    },    normalSub:function() {  //正常的审核和驳回，不包含重新提交各情况判断        var msgText = $("#ideaText").val();        if (msgText == undefined || msgText == "") {            if (mustGiveMsg == true && mustGiveMsg != "remove") {                commons.alertMsg("请您填写意见");            }        }        if (saveMsged == 0 && msgText && msgText != "" && mustGiveMsg != "remove") {            commons.saveMsg();        } else {            if (mustGiveMsg == false || mustGiveMsg == "remove" || saveMsged == 1) {                commons.finished();            } else {                $(".locked").fadeOut();            }        }    }};